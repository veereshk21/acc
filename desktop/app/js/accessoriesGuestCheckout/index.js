/**
 *
 * This is the entry file for the application
 *
* */
import 'babel-polyfill';
import React from 'react';
import ReactDOM from 'react-dom';
import injectTapEventPlugin from 'react-tap-event-plugin';
import a11y from 'react-a11y';
import axios from 'axios';
import configureStore from './../store';
import provider from './../provider';
import createRoutes from './routes';
import { orderDetails, cqContent, asyncCallStatus, applePayAvailable, editState, cyberSourceData } from './reducer';
import { notification } from '../common/NotificationBar/reducer';
import { EDIT_STATE } from './constants';

import '../../css/base/base.scss';
import '../../css/base/fonts.scss';
import '../../css/layout/grid.scss';
import '../../css/layout/layout.scss';
import '../../css/modules/arrows.scss';
import '../../css/modules/buttons.scss';
import '../../css/modules/icons.scss';
import '../../css/modules/modules.scss';
import './../../css/modules/modal.scss';
import '../../css/modules/radioButtons.scss';
import '../../css/modules/singles.scss';
import '../../css/states/states.scss';
import './../../css/modules/menu.scss';
import './../../css/modules/checkbox.scss';
import './../../css/modules/accordion.scss';
import './../../css/pages/accGuestCheckout/accGuestCheckout.scss';
import cq from './../../cq/cq_accGuestCheckout.json';
// import reviewOrderJSON from './../../json/accGuestCheckout/reviewOrderJSON.js'; // eslint-disable-line
// window.reviewOrderJSON = {"output":{"restockFee": null,"tmpMdOpted":false,"checkoutStates":{"shippingAddressRequired":false,"shippingAddressChangeRequired":false,"poBoxShippingAddress":false,"shippingAddressValidationError":false,"shippingMethodRequired":false,"paymentRequired":false,"pastDuePaymentRequired":false,"showPaymentSection":true,"showShippingAddress":true,"showDeliveryMethod":true,"newCard":false,"cvvNeeded":false,"contactInfoRequired":false,"instantCreditAllocationsChanged":false,"instantCreditOrder":false,"tradesExceedItems":false,"creditCardZipEditable":false},"stepsCompleted":{"billingAddress":true,"shippingAddress":true,"deliveryInfo":true,"paymentInfo":true},"shippingInfo":{"shippingInfoUpdated":false,"sameAsBilling":true,"ispuEligibleFlag":false,"addressInfo":{"firstName":"EDWIN OMAR","lastName":"MENDEZ","companyName":null,"address1":"5055 North Point Pkwy","address2":"","city":"ALPHARETTA","state":"GA","zipcode":"30022","businessName":null,"postalCode":null,"email":"edwin.o.badillo@gmail.com","phoneNumber":"7325096108"},"contactInfo":{"emailAddress":"edwin.o.badillo@gmail.com","phoneNumber":"7325096108","firstName":"EDWIN OMAR","lastName":"MENDEZ","smsMdn":null,"activeSMSCapableMtnList":null},"shippingTypesInfo":[{"estimatedDeliveryDate":"2018-08-29 00:00:00","estimatedDeliveryDateText":"Wed 8/29","shippingDescription":"2 DAY BY 8PM","shippingOptionId":"SHP003","shippingCost":"0.00","shortDescription":"2 DAY BY 8PM","active":false,"addedShippingOptionId":true,"signatureRequired":"true","description":"Estimated to arrive on Wed, Aug 29. 2 DAY BY 8PM. Signature required.","depletionLocationCode":null,"sddAvailableWindows":null},{"estimatedDeliveryDate":"2018-08-28 00:00:00","estimatedDeliveryDateText":"Tue 8/28","shippingDescription":"NEXT DAY BY 8PM","shippingOptionId":"SHP004","shippingCost":"12.99","shortDescription":"NEXT DAY BY 8PM","active":false,"addedShippingOptionId":false,"signatureRequired":"true","description":"Estimated to arrive on Tue, Aug 28. NEXT DAY BY 8PM. Signature required.","depletionLocationCode":null,"sddAvailableWindows":null},{"estimatedDeliveryDate":"2018-08-28 10:30:00","estimatedDeliveryDateText":"Tue 8/28 by 10:30AM","shippingDescription":"NEXT DAY BY 10:30AM","shippingOptionId":"SHP005","shippingCost":"14.99","shortDescription":"NEXT DAY BY 10:30AM","active":false,"addedShippingOptionId":false,"signatureRequired":"true","description":"Estimated to arrive on Tue, Aug 28. NEXT DAY BY 10:30AM. Signature required.","depletionLocationCode":null,"sddAvailableWindows":null}],"storeDetail":{"storeHeader":null,"storeName":null,"storeAddress":null,"deviceAvailable":false,"distance":null,"appendedStoreTiming":null,"longitude":null,"storeId":null,"netaceLocationCode":null,"latitude":null,"seoUrlName":null,"storeClosingTime":null},"tradeIn":true,"tradeInAddress":{"firstName":"EDWIN OMAR","lastName":"MENDEZ","address1":"5055 North Point Pkwy","address2":"","city":"ALPHARETTA","state":"GA","zipcode":"30022","companyName":null},"nonSddEligibleMsg":null,"selectedSDDWindow":null,"poboMessage":null,"vendorShippingTypesInfo":null,"verizonCommerceItemsNames":null,"vendorCommerceItemsNames":null,"vendorShippingOptionExists":false,"ispudetailsInfo":{"storeAddress":null,"storeHours":null,"storeId":null,"storeName":null,"phoneNumber":null,"distance":null,"totalItems":0,"availItems":0,"latitdude":0.0,"longtitude":0.0,"availItemName":null}},"billingInfo":{"billToAccountEligible":false,"creditCardZipEditable":false,"billingAddress":{"firstName":"EDWIN OMAR","lastName":"MENDEZ","businessName":null,"zipcode":"30022","state":"GA","address2":null,"address1":"5055 North Point Pkwy","companyName":null,"city":"Alpharetta","sameAsShipping":false},"masterpass3DSecure":null,"billToAccountNumber":null,"creditCardInfo":{"savedCardNickName":null,"preselectCard":null,"creditCardNumber":"XXXX-XXXX-XXXX-1111","creditCardExpMonth":"08","creditCardExpYear":"2023","billingZipCode":null,"creditCardType":"visa","creditCardVerificationNumber":null,"creditCardBIN":null,"cvvRequired":false},"selectedPaymentMode":"newCard","giftCardList":[],"savedCardInfo":[],"applePayResponseInfo":null,"masterpassResponseInfo":{"emailAddress":null,"cardType":null,"lastDigits":null,"creditCardBIN":null,"masterpassSelected":false},"masterpassError":false,"masterpassErrorMessage":null,"cybersourecPreAuthFailure":false,"cybersourecPreAuthFailureErrorMessage":null,"paypalEmailAddress":null,"expirationMonths":["01","02","03","04","05","06","07","08","09","10","11","12"],"expirationYears":["2018","2019","2020","2021","2022","2023","2024","2025","2026","2027"]},"tradeInPromoDetails":null,"transformedTradeInPromoDetails":null,"deviceConfigInfo":{"devices":[],"npaNxxdetails":{"zipCode":null,"state":null,"city":null,"success":false,"mtns":null,"states":null,"cities":null},"deviceAddressUpdated":false,"accessories":null},"termsAndConditionsInfo":null,"orderId":"T6423c6e6a9ef111ce7f97cf3302e3790{d4}","dueToday":"64.64","dueMonthly":"0.00","totalDueMonthlyPlanAndDevice":"0.00","displayUpgradeFee":false,"instantCreditDetails":{"totalInstantCredit":null,"optionalDownPayment":null,"twoYearDevicesInstantCredit":null,"fullRetailInstantCredit":null,"accessoriesInsantCredit":null,"taxesInstantCredit":null,"accountCredit":null},"selectedVendorShippingType":null,"subtotalDueToday":"59.99","totalOrderTax":"4.65","depositAmount":"0.00","employeeDiscount":"0.00","saveAmount":"0.00","totalUpgradeFee":"0.00","recycleDeviceAppraise":"0.00","edgeOrderTotalDownPayment":"0.00","flow":"NAO","states":["AK","AL","AR","AZ","CA","CO","CT","DC","DE","FL","GA","HI","IA","ID","IL","IN","KS","KY","LA","MA","MD","ME","MI","MN","MO","MS","MT","NC","ND","NE","NH","NJ","NM","NV","NY","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VA","VT","WA","WI","WV","WY"],"authInfo":{"clients":{"CARDINAL3DSECURE":{"token":"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJqdGkiOiJUNjQyM2M2ZTZhOWVmMTExY2U3Zjk3Y2YzMzAyZTM3OTB7ZDR9IiwiaWF0IjoxNTM1Mzc3OTQxLCJpc3MiOiI1OWY5ZDQyOWQxZjY3NDE1N2MwMDI4YzAiLCJPcmdVbml0SWQiOiI1NmViYWM3NTMzZmFkZDcyNmNhMjQwYTciLCJQYXlsb2FkIjp7Ik9yZGVyRGV0YWlscyI6eyJDdXJyZW5jeUNvZGUiOiJVU0QiLCJBbW91bnQiOiI2NDY0IiwiT3JkZXJOdW1iZXIiOiJUNjQyM2M2ZTZhOWVmMTExY2U3Zjk3Y2YzMzAyZTM3OTB7ZDR9IiwiVHJhbnNhY3Rpb25JZCI6IjA2YWZhOTQ0LTZlMjAtNGVlYy04ZDliLTczMGU0NWZlYzQ4MCJ9fSwiT2JqZWN0aWZ5UGF5bG9hZCI6dHJ1ZSwiUmVmZXJlbmNlSWQiOiJQT1RENjFjYTc2NTk4OTg0NDY0Yjg5YjkyMDZhOTljYjllYzVkNCIsImV4cCI6MTUzNTM4NTE0MX0.INqAJwLP3UVRxWoSawrD53m31bzmmgs0RN6dJUqZlUM","tokenType":"JWT","featuresList":{"binDetection":true}}}},"giftCard1Info":null,"giftCard2Info":null,"opalImpersonator":null,"stackableDataDescription":null,"stackbleDataAggregateTotals":null,"edgeUpBuyOutAmount":"0.00","edgeupBuyOutMtnList":null,"tapFeatureDetails":null,"promotionList":null,"cpcOrder":false,"instantCreditAmount":"0.00","loginMTN":"","useISPUService":false,"smartFamilyInCart":false,"standaloneAccessories":true,"amountAfterInstantCredit":"0.00","datagapDisclosureAgreement":null,"pastDueAmount":"0.00","pastDueExist":false,"pastDueAmountPaid":false,"plans":null,"devices":{"dueMonthly":0.0,"totalActivationFee":0.0,"deviceTotalDueMonthly":0.0,"dueToday":0.0,"accessories":[],"accessoriesBundle":[],"globalPromotions":[],"items":null,"buddyUpgrade":false},"masterpassConfigInfo":{"checkoutId":"086d17da498d4a4685096e96bdb1d567","allowedCardTypes":["master","amex","diners","discover","jcb","maestro","visa"],"shippingLocationProfile":"US","amount":"64.64","cartId":"T6423c6e6a9ef111ce7f97cf3302e3790{d4}","currency":"USD","suppress3Ds":false,"callbackUrl":"https://www.verizonwireless.com/od/cust/guest/checkout/masterpass/paymentData"},"masterpassEnabled":true,"paymentMethodRedesign":true,"accountLevelDiscountList":null,"militaryDiscount":0.0,"accessories":[{"scene7ImageUrl":"https://ss7.vzw.com/is/image/VerizonWireless/ue-wonderboom-bluetooth-speaker-phantom-black-uewndrboomblk-iset?$acc-med$","name":"WONDERBOOM","actualPrice":59.99,"originalPrice":99.99,"percentageOffTxt":"40.00% off","itemTotal":59.99,"quantity":1,"commerceItemId":"T6423c6e6a9ef111ce7f97cf3302e3790{d4}_accessory_1","color":"Phantom Black","size":null,"inventoryStatus":"","inventoryAvailableDate":"","prodId":"acc7400036","skuId":"sku2320116","sorId":"UEWNDRBOOMBLK","promoMessage":null,"hasEcpdDiscount":false,"mobileAppImageName":"","imageUrl":"https://ss7.vzw.com/is/image/VerizonWireless/ue-wonderboom-bluetooth-speaker-phantom-black-uewndrboomblk-iset?$acc-med$","hasBogoDiscount":false,"price":59.99,"discountPrice":40.0,"retailPrice":59.99,"associatedDeviceSkus":null,"prodName":"","instantCreditApplied":null,"discounted":true}],"accessoriesBundle":null,"taxes":[{"name":"Taxes & Fees","price":"4.65","discountPrice":"0.00","retailPrice":"0.00","originalPrice":"0.00","city":"ALPHARETTA","state":"GA","taxCalculated":true,"taxNotCalculatedMsg":null,"instantCreditApplied":null}],"dueMonthlyView":{"title":null,"dueMonthlyPrice":null,"items":null,"tmpMd":null},"dueTodayView":{"title":"Due Today","dueTodayPrice":"64.64","items":[],"accessories":[{"name":"WONDERBOOM","size":null,"color":"Phantom Black","quantity":"1","price":"59.99","wasPrice":"99.99","deviceProductDisplayName":"","label":"Price","discounted":true,"instantCreditApplied":null,"discountPercentage":40.0,"discountPrice":40.0}],"accessoriesBundle":[],"additionalCharges":{"title":"Additional Charges","items":[{"name":"Taxes & Fees","price":"4.65","description":"ALPHARETTA, GA","instantCreditDescription":null},{"name":"2 DAY BY 8PM","price":"0.00","description":null,"instantCreditDescription":null}]},"price":null},"cartDetailURL":"/od/cust/cart/getCartDetails","validateAndPersistDeviceInfoURL":"/od/cust/guest/checkout/validateAndPersistDeviceInfo","npaNxxNumberZipCodeURL":"/od/cust/guest/checkout/npaNxxNumberZipCode","getMarketDetailsURL":"/od/cust/guest/checkout/getMarketDetails","paypalCmpiLookupURL":"/od/cust/guest/checkout/paypal/cmpilookup?triggerFrom=PAYMENT","smsAuthenticationComplete":false,"securePinPageUrl":null,"fetchSMSDevicesUrl":null,"sendSMSUrl":null,"validateAuthCodeUrl":null,"totalActivationFee":"0.00","itemOnJaxPlan":false,"comboOrder":false,"anyLineFreeVO":null,"giftCardsEnabled":true,"giftCardsLimit":2,"giftCardsUsed":null,"submitGiftCardURL":"/od/cust/guest/checkout/updateGiftCard","checkGiftCardBalanceURL":"/od/cust/guest/checkout/checkGiftCardBalance","removeGiftCardURL":"/od/cust/guest/checkout/removeGiftCard","balanceCreditCardAmount":"64.64","totalGiftCardAmount":null,"reasonErrorCode":null,"reasonErrorMsg":null,"validAuthCode":false,"numOfAttempts":0,"promoBanners":null,"cancelCartURL":"/od/cust/cart/clearCart","mmplanEnabled":false,"payPalEnabled":true,"securePinEligible":false,"ispuBTAPaymentUpdated":false,"flipIspuToShipping":false,"iconicFlow":true,"updatePaymentInfoURL":"/od/cust/guest/checkout/updatePaymentInfo","updateShippingInfoURL":"/od/cust/guest/checkout/updateShippingInfo","updateBillingAddressInfoURL":"/od/cust/guest/checkout/updatePaymentInfo","handleCardinalResponseURL":"/od/cust/guest/checkout/handleCardinal3DResponse","pastDueCheckoutURL":null,"updateDeviceServiceAddressURL":null,"submitOrderURL":"/od/cust/guest/checkout/submitOrder","storeDetailsURL":"/od/cust/guest/checkout/storeDetails","mainViewSubTitle":null,"pieEnabled":true,"eppAccessoryTermsAndConditionDisplay":false,"googleMapAPI":{"client":"gme-verizonwireless2","channel":"vzw-mobile","draggable":true},"selectedShippingType":{"type":"SHIPPING","shippingTypeName":"2 DAY BY 8PM","price":0.0,"discountPrice":0.0,"estimatedDeliveryDate":"2018-08-29 00:00:00","selectedFormattedWindow":null},"applePaymentRequest":{"totalAmount":"64.64","orderTotalLabel":"VERIZON (TOTAL PENDING)","showAvailableShippingOptions":false,"requestBillingInfoFromApple":["postalAddress"],"requestShippingInfoFromApple":["email"],"lineItems":[{"label":"PAYMENT NOT PROCESSED UNTIL WE VERIFY YOUR ORDER","amount":"0.0","type":"pending"}]},"applePayEnabled":true,"appleMerchantIdentifier":"merchant.com.vzw.MVM","bicRepresentationChangeEnabled":true,"isHLLPlanInOrder":false},"errorMap":null,"statusMessage":null,"statusCode":"00"};

__webpack_public_path__ = window.resourceBaseUrl;
if (process.env.NODE_ENV !== 'production') {
  a11y(React, ReactDOM);
  // window.reviewOrderJSON = reviewOrderJSON;
}

axios.get(__webpack_public_path__ + cq).then((result) => {
  const { stepsCompleted } = window.reviewOrderJSON.output;
  const initialState = {
    orderDetails: window.reviewOrderJSON.output || {},
    cqContent: result.data,
    editState: {
      [EDIT_STATE.SHIPPING_ADDRESS]: !stepsCompleted.shippingAddress,
      [EDIT_STATE.SHIPPING_METHOD]: !stepsCompleted.deliveryInfo && stepsCompleted.shippingAddress,
      [EDIT_STATE.PAYMENT]: !(stepsCompleted.paymentInfo && stepsCompleted.billingAddress) && stepsCompleted.shippingAddress && stepsCompleted.deliveryInfo,
    },
  };
  const store = configureStore(initialState, {
    orderDetails, cqContent, asyncCallStatus, applePayAvailable, notification, editState, cyberSourceData,
  });

  injectTapEventPlugin(); // Instant TapEvents for React http://facebook.github.io/react/

  const render = () => {
    ReactDOM.render(
      provider(store, createRoutes(store)),
      document.getElementById('app')
    );
  };

  render();
});
